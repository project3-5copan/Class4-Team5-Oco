{"ast":null,"code":"import { sum } from \"d3-array\";\nimport { slidingWindow } from \"../utils\";\nimport { WMA as defaultOptions } from \"./defaultOptionsForComputation\";\nexport default function () {\n  var options = defaultOptions;\n\n  var calculator = function calculator(data) {\n    var _options = options,\n        windowSize = _options.windowSize,\n        sourcePath = _options.sourcePath;\n    var weight = windowSize * (windowSize + 1) / 2;\n    var waverage = slidingWindow().windowSize(windowSize).sourcePath(sourcePath).accumulator(function (values) {\n      var total = sum(values, function (v, i) {\n        return (i + 1) * v;\n      });\n      return total / weight;\n    });\n    return waverage(data);\n  };\n\n  calculator.undefinedLength = function () {\n    var _options2 = options,\n        windowSize = _options2.windowSize;\n    return windowSize - 1;\n  };\n\n  calculator.options = function (newOptions) {\n    if (newOptions === undefined) {\n      return options;\n    }\n\n    options = Object.assign(Object.assign({}, defaultOptions), newOptions);\n    return calculator;\n  };\n\n  return calculator;\n}","map":null,"metadata":{},"sourceType":"module"}